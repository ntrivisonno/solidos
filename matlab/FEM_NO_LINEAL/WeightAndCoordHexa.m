function [weight, xi, yi, zi] = WeightAndCoordHexa(npg,i)
  %-------------------------------------------------
  % funcion que calcula las coord y los pesos de los ptos de integracion
  % en un cubo de coord naturales -1<=psi<=1,-1<=eta<=1,-1<=ceda<=1
  % npg -> # de ptos de integracion
  % i -> pto de integracion deseado, opcional, si no especifico el pto, me va a devolver elv ector con de peso de todo los ptos
  %-------------------------------------------------
	 
  switch(npg)
    case 1
      CO = [0 0 0];
      WE = 8.;
      
    case 6
      % Irons 1971, Dunavant 1986
      CO=[
          1,0,0
          -1,0,0
          0,1,0
          0,-1,0
          0,0,1
          0,0,-1
      ];
        
      WE = [
            1.333333333333333
            1.333333333333333
            1.333333333333333
            1.333333333333333
            1.333333333333333
            1.333333333333333
      ];
    case 8
      CO=[
          -0.577350269189626,-0.577350269189626,-0.577350269189626
          -0.577350269189626,-0.577350269189626,+0.577350269189626
          -0.577350269189626,+0.577350269189626,-0.577350269189626
          -0.577350269189626,+0.577350269189626,+0.577350269189626
          +0.577350269189626,-0.577350269189626,-0.577350269189626
          +0.577350269189626,-0.577350269189626,+0.577350269189626
          +0.577350269189626,+0.577350269189626,-0.577350269189626
          +0.577350269189626,+0.577350269189626,+0.577350269189626
      ];
        
      WE = [
            1
            1
            1
            1
            1
            1
            1
            1
      ];
      
    case 13
    % Hellen 1972
      l = 0.88030430;
      x = -0.49584802;
      m = 0.79562143;
      g = 0.025293237;
      A = 1.68421056;
      B = 0.54498736;
      C = 0.507644216;
    
      CO = [
	    0 0 0
	    l x x
	    -l -x -x
	    x l x
	    -x -l -x
	    x x l
	    -x -x -l
	    m m l
	    -m -m -l
	    m g m
	    -m -g -m
	    g m m
	    -g -m -m
      ];
    
      WE = [
	    A
	    B
	    B
	    B
	    B
	    B
	    B
	    C
	    C
	    C
	    C
	    C
	    C
      ];
      
    case 14
      % Irons 1971, Wriggers 2008
      B6 =  0.8864265927977839335180055401662; % 320/361 
      b = 0.79582242575422146326454882047614; % sqrt(19/30)
      C8 = 0.33518005540166204986149584487535; % 121/361 
      c = 0.75878691063932814626903427811227; % sqrt(19/30) 
      
      CO=[
          b 0 0
          0 b 0
          0 0 b
          -b 0 0
          0 -b 0
          0 0 -b
          c c c
          c c -c
          c -c c
          c -c -c
          -c c c
          -c c -c
          -c -c c
          -c -c -c
      ];
      
      WE = [
            B6
            B6
            B6
            B6
            B6
            B6
            C8
            C8
            C8
            C8
            C8
            C8
            C8
            C8
            C8
            C8
            C8
            C8
      ];
        
    case 27
      CO=[
          -7.745966692414834e-001   -7.745966692414834e-001   -7.745966692414834e-001
          -7.745966692414834e-001   -7.745966692414834e-001                         0
          -7.745966692414834e-001   -7.745966692414834e-001    7.745966692414834e-001
          -7.745966692414834e-001                         0   -7.745966692414834e-001
          -7.745966692414834e-001                         0                         0
          -7.745966692414834e-001                         0    7.745966692414834e-001
          -7.745966692414834e-001    7.745966692414834e-001   -7.745966692414834e-001
          -7.745966692414834e-001    7.745966692414834e-001                         0
          -7.745966692414834e-001    7.745966692414834e-001    7.745966692414834e-001
          0   -7.745966692414834e-001   -7.745966692414834e-001
          0   -7.745966692414834e-001                         0
          0   -7.745966692414834e-001    7.745966692414834e-001
          0                         0   -7.745966692414834e-001
          0                         0                         0
          0                         0    7.745966692414834e-001
          0    7.745966692414834e-001   -7.745966692414834e-001
          0    7.745966692414834e-001                         0
          0    7.745966692414834e-001    7.745966692414834e-001
          7.745966692414834e-001   -7.745966692414834e-001   -7.745966692414834e-001
          7.745966692414834e-001   -7.745966692414834e-001                         0
          7.745966692414834e-001   -7.745966692414834e-001    7.745966692414834e-001
          7.745966692414834e-001                         0   -7.745966692414834e-001
          7.745966692414834e-001                         0                         0
          7.745966692414834e-001                         0    7.745966692414834e-001
          7.745966692414834e-001    7.745966692414834e-001   -7.745966692414834e-001
          7.745966692414834e-001    7.745966692414834e-001                         0
          7.745966692414834e-001    7.745966692414834e-001    7.745966692414834e-001
      ];
      WE = [
            1.714677640603567e-001
            2.743484224965707e-001
            1.714677640603567e-001
            2.743484224965707e-001
            4.389574759945130e-001
            2.743484224965707e-001
            1.714677640603567e-001
            2.743484224965707e-001
            1.714677640603567e-001
            2.743484224965707e-001
            4.389574759945130e-001
            2.743484224965707e-001
            4.389574759945130e-001
            7.023319615912208e-001
            4.389574759945130e-001
            2.743484224965707e-001
            4.389574759945130e-001
            2.743484224965707e-001
            1.714677640603567e-001
            2.743484224965707e-001
            1.714677640603567e-001
            2.743484224965707e-001
            4.389574759945130e-001
            2.743484224965707e-001
            1.714677640603567e-001
            2.743484224965707e-001
            1.714677640603567e-001
      ];
    otherwise
      n1 = npg^(1/3);
      if isinteger(n1)
        [w1, xi1] = fillWeightAndCoordBar(n1);
        weight = zeros(1,npg);
        xi = weight;
        j = 0;
        for k=1:n1
          for l=1:n1
            j = j+1;
            weight(j) = w1(k)*w1(l);
            xi(j) = xi1(k)*xi1(l);
               end
        end
      else
        error('Wrong number of Gauss points');
      end
  end
  
  if nargin==2
    if i>npg
      error('Number of Gauss points exceeded');
    end
    xi = CO(i,1);
    yi = CO(i,2);
    zi = CO(i,3);
    weight = WE(i);
  else
    xi = CO(:,1);
    yi = CO(:,2);
    zi = CO(:,3);
    weight = WE;
  end
  
end
